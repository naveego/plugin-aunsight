{
  "id": "plugin-filereader",
  "displayName": "File Reader",
  "description": "Publisher which extracts data from delimited and fixed width column flat files.",
  "apiVersion": "2",
  "versionDescription": "Version 4",
  "version": "4.0.0",
  "iconFile": "icon.png",
  "executable": "PluginFileReader",
  "kind": "publisher",
  "os": "$GOOS",
  "arch": "$GOARCH",
  "accessGroups": [],
  "canConfigureRealTime": false,
  "canProduceMultipleSchemas": true,
  "canAcceptQueryBasedSchemas": true,
  "canUseOAuth": false,
  "canConfigureWrite": true,
  "canWrite": true,
  "canConfigureReplication": true,
  "canWriteReplication": true,
  "querySchema": {
    "ui": {
      "ui:widget": "code",
      "ui:options": {
        "language": "sql"
      }
    },
    "schema": {
      "type": "string"
    }
  },
  "configSchema": {
    "ui": {
      "ui:order": ["GlobalColumnsConfigurationFile","RootPaths"],
      "RootPaths": {
        "items": {
          "ui:order": ["RootPath", "Filter", "Name", "CleanupAction", "ArchivePath", "Mode", "SkipLines", "Delimiter", "HasHeader", "ExcelColumns", "ExcelCells", "ColumnsConfigurationFile", "Columns"],
          "Columns": {
            "items": {
              "ui:order": ["ColumnName", "IsKey", "TrimWhitespace", "ColumnStart", "ColumnEnd"]
            },
            "ExcelCells": {
              "ui:order": ["ColumnName", "ColumnIndex", "RowIndex"]
            }
          }
        }
      }
    },
    "schema": {
      "type": "object",
      "properties": {
        "GlobalColumnsConfigurationFile": {
          "type": "string",
          "title": "Global Columns Configuration File",
          "description": "Global configuration file for columns in fixed width root paths. Overridden by specific columns configuration files.",
          "default": ""
        },
        "RootPaths": {
          "title": "Root Paths",
          "description": "The folder(s) containing the files.",
          "type": "array",
          "minItems": 0,
          "items": {
            "type": "object",
            "properties": {
              "RootPath": {
                "title": "Root Path",
                "description": "The folder containing the files",
                "type": "string"
              },
              "Filter": {
                "type": "string",
                "description": "Filters used to select files beneath the root path. Each filter should be a regular expression.",
                "default": "*.csv"
              },
              "Name": {
                "type": "string",
                "description": "Name for the schema and table. If one is not provided the folder name will be used.",
                "default": ""
              },
              "CleanupAction": {
                "type": "string",
                "title": "Cleanup Action",
                "description": "Action taken to clean up after reading.",
                "default": "Nothing",
                "examples": ["string"],
                "enum": ["Nothing", "Delete", "Archive"]
              },
              "ArchivePath": {
                "type": "string",
                "title": "Archive Folder",
                "description": "The folder to move files to after processing, if cleanup action is \"archive\".",
                "default": "",
                "examples": ["string"]
              },
              "Mode": {
                "type": "string",
                "title": "Mode",
                "description": "Mode to use when reading target files.",
                "default": "Delimited",
                "enum": ["Delimited", "Fixed Width Columns", "Excel"]
              },
              "Delimiter": {
                "type": "string",
                "title": "Delimiter",
                "description": "The delimiter for delimited files.",
                "default": ",",
                "examples": [",", "|"],
                "pattern": ""
              },
              "HasHeader": {
                "type": "boolean",
                "title": "Has Header",
                "description": "Does the file have a header row?",
                "default": false,
                "examples": [true]
              },
              "SkipLines": {
                "title": "Skip Lines",
                "description": "The number of lines to skip at the top of the file.",
                "default": 0,
                "type": "number"
              },
              "ExcelColumns": {
                "type": "string",
                "title": "Excel Columns",
                "description": "The columns to read from an Excel file (ex. 0, 2-5, 7, 10, 12-15).",
                "default": "",
                "pattern": ""
              },
              "ExcelCells": {
                "readOnly": false,
                "type": "array",
                "title": "Excel Cells",
                "description": "Cells to include on all records.",
                "items": {
                  "type": "object",
                  "properties": {
                    "ColumnName": {
                      "title": "Column Name",
                      "description": "The name of the column.",
                      "type": "string"
                    },
                    "ColumnIndex": {
                      "title": "Column Index",
                      "description": "The column index of the cell.",
                      "type": "number"
                    },
                    "RowIndex": {
                      "title": "Row Index",
                      "description": "The row index of the cell.",
                      "type": "number"
                    }
                  },
                  "required": ["ColumnName", "ColumnIndex", "RowIndex"]
                }
              },
              "ColumnsConfigurationFile": {
                "type": "string",
                "title": "Columns Configuration File",
                "description": "Path to the columns configuration file for fixed width files (optional)"
              },
              "Columns": {
                "readOnly": false,
                "type": "array",
                "title": "Columns",
                "description": "Columns for fixed column width files",
                "items": {
                  "type": "object",
                  "properties": {
                    "ColumnName": {
                      "title": "Column Name",
                      "description": "The name of the column.",
                      "type": "string"
                    },
                    "ColumnStart": {
                      "title": "Column Start",
                      "description": "The index of the first character of the column (0 is the first index).",
                      "type": "number"
                    },
                    "ColumnEnd": {
                      "title": "Column End",
                      "description": "The index of the last character of the column.",
                      "type": "number"
                    },
                    "IsKey": {
                      "title": "Is Key",
                      "description": "Is this column the key property?",
                      "default": false,
                      "type": "boolean"
                    },
                    "TrimWhitespace": {
                      "title": "Trim Whitespace",
                      "description": "Trim all leading and trailing whitespace?",
                      "default": false,
                      "type": "boolean"
                    }
                  },
                  "required": ["ColumnName", "ColumnStart", "ColumnEnd"]
                }
              }
            },
            "required": ["RootPath", "Filter", "Mode"]
          }
        }
      },
      "required": []
    }
  }
}
